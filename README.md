# 한국 공문서 합성 데이터셋 생성기 (Korean Document Synthesis Dataset Generator)

## 프로젝트 개요

이 프로젝트는 AI 문서 분류 모델 학습을 위한 한국 공문서 합성 데이터셋을 생성하는 도구입니다. 주민등록등본(JU)과 가족관계증명서(GA) 두 가지 문서 유형을 지원하며, 각각 다양한 변형과 회전을 통해 총 1280장의 이미지를 생성합니다.

## 📊 데이터셋 구성

### 전체 데이터셋: 1280장

#### 주민등록등본(JU): 960장
- **문서 종류**: 3가지 (등본1, 등본2, 등본3)
- **바코드 종류**: 4가지
  - 우측X, 하단X (TY00)
  - 우측O, 하단O (TY11) 
  - 우측O, 하단X (TY10)
  - 우측X, 하단O (TY01)
- **주민번호 공개 여부**: 2가지 (전체공개/뒷자리미공개)
- **세대원 수**: 1명, 2명, 3-5명 (각 바코드 종류별로 10장씩)
- **회전**: 4방향 (0°, 90°L, 90°R, 180°)

#### 가족관계증명서(GA): 320장
- **문서 종류**: 2가지 (가족1, 가족2)
- **자녀 수**: 4가지 (0명, 1명, 2명, 3명)
- **회전**: 4방향 (0°, 90°L, 90°R, 180°)

## 🎯 탐지 결과 클래스 (총 8개)

1. **가족관계증명서**: GA-0, GA-L, GA-R, GA-180
2. **주민등록등본**: JU-0, JU-L, JU-R, JU-180

## 📁 파일명 규칙

### 주민등록등본(JU)
```
JU-{ROT}-{JUMIN_TYPE}-{INDEX:04d}.jpg
```
- `ROT`: 0 (정상), L (왼쪽 90°), R (오른쪽 90°), 180 (180°)
- `JUMIN_TYPE`: OPEN (전체공개), MASK (뒷자리미공개)
- `INDEX`: 4자리 인덱스 (각 회전과 주민번호 타입별로 독립적으로 카운트)

### 가족관계증명서(GA)
```
GA-{ROT}-{JUMIN_TYPE}-{INDEX:04d}.jpg
```
- `ROT`: 0 (정상), L (왼쪽 90°), R (오른쪽 90°), 180 (180°)
- `JUMIN_TYPE`: MASK (뒷자리미공개)
- `INDEX`: 4자리 인덱스 (각 회전별로 독립적으로 카운트)

## 🚀 설치 및 실행

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. 전체 데이터셋 생성
```bash
# 주민등록등본(JU) 생성
python src/batch_generator.py

# 가족관계증명서(GA) 생성  
python src/batch_generator_ga.py
```

### 3. 개별 테스트
```bash
# JU 로직 테스트
python test_ju_logic.py

# GA 배우자 로직 테스트
python test_ga_spouse_logic.py
```

## 📂 프로젝트 구조

```
kdocs_synth/
├── assets/
│   ├── fonts/                    # 폰트 파일
│   ├── samples/                  # 샘플 이미지
│   └── templates/                # 문서 템플릿
├── configs/
│   ├── field_definitions/        # 필드 정의 YAML
│   └── *_layout.yaml            # 레이아웃 좌표 YAML
├── src/
│   ├── data_factory.py          # 데이터 생성 로직
│   ├── templates_juga.py        # 문서 렌더링 템플릿
│   ├── batch_generator.py       # JU 배치 생성
│   ├── batch_generator_ga.py    # GA 배치 생성
│   ├── rotator.py               # 이미지 회전 및 저장
│   └── extract_layout.py        # 레이아웃 추출 도구
├── outputs/
│   └── dataset/                 # 생성된 데이터셋
├── tests/                       # 테스트 파일들
└── README.md
```

## 🔧 주요 기능

### 1. 데이터 생성
- **가짜 개인정보 생성**: 이름, 주민등록번호, 생년월일 등
- **가중치 기반 랜덤 선택**: 변동사유, 세대구성 사유 등
- **조건부 데이터 생성**: 자녀 수에 따른 배우자 포함 여부

### 2. 문서 렌더링
- **고품질 텍스트 렌더링**: KoPub World 폰트 사용
- **정확한 좌표 배치**: YAML 기반 레이아웃 정의
- **주민번호 마스킹**: 조건부 마스킹 지원

### 3. 이미지 처리
- **4방향 회전**: 0°, 90°L, 90°R, 180°
- **일관된 파일명**: 체계적인 네이밍 규칙
- **매니페스트 생성**: CSV 기반 메타데이터

## 📋 특별 기능

### 주민등록등본(JU) 특화 기능
- **세대구성 사유 및 일자**: 11가지 사유 중 가중치 기반 선택
- **변동사유 빈칸 처리**: 30% 확률로 빈칸 생성
- **발생일/신고일**: 빈칸(5%), 대시(42.5%), 날짜(42.5%) 확률
- **세대원 수별 데이터**: 1명, 2명, 3-5명 지원

### 가족관계증명서(GA) 특화 기능
- **자녀 수별 배우자 로직**: 자녀 0명일 때 배우자 제외
- **템플릿별 자녀 수**: 0명, 1명, 2명, 3명 지원
- **관계 정보 출력**: 본인, 부, 모, 배우자, 자녀

## 🛠️ 개발 도구

### 레이아웃 추출 도구
```bash
python src/extract_layout.py
```
- GUI 기반 좌표 추출
- 실시간 미리보기
- YAML 형식 저장

### 테스트 스크립트
- `test_ju_logic.py`: JU 생성 로직 테스트
- `test_ga_spouse_logic.py`: GA 배우자 로직 테스트
- `test_household_weights.py`: 세대구성 사유 가중치 테스트

## 📈 데이터 품질

### 검증된 기능
- ✅ 정확한 세대원 수 생성 및 렌더링
- ✅ 주민번호 마스킹/공개 구분
- ✅ 배우자 조건부 생성 (GA)
- ✅ 가중치 기반 랜덤 선택
- ✅ 4방향 회전 이미지 생성
- ✅ 일관된 파일명 규칙

### 품질 보장
- **고해상도 출력**: 원본 템플릿 품질 유지
- **정확한 좌표**: 수동 추출된 정밀 좌표 사용
- **다양한 변형**: 실제 문서와 유사한 변형 생성
- **메타데이터**: 완전한 매니페스트 파일 제공

## 🤝 기여

프로젝트에 기여하고 싶으시다면:
1. 이슈를 통해 버그나 개선사항을 보고해주세요
2. 풀 리퀘스트를 통해 코드 개선을 제안해주세요
3. 문서화 개선이나 테스트 추가를 도와주세요

## 📄 라이선스

이 프로젝트는 교육 및 연구 목적으로 개발되었습니다.

## 📞 문의

프로젝트에 대한 문의사항이 있으시면 이슈를 통해 연락해주세요.

---

**🎉 프로젝트 완료!** 총 1280장의 한국 공문서 합성 데이터셋이 성공적으로 생성되었습니다. 