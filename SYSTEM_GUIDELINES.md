# KDOCS_SYNTH 시스템 지침

## 🎯 프로젝트 목표
한국 공문서 합성 데이터셋 생성기 - AI 문서 분류 모델 학습을 위한 가짜 공문서 이미지 생성

## 📋 개발 원칙

### 1. 코드 품질
- **가독성**: 명확한 변수명과 함수명 사용
- **모듈화**: 기능별로 분리된 클래스와 함수
- **재사용성**: 공통 기능은 별도 모듈로 분리
- **문서화**: 주요 함수와 클래스에 docstring 작성

### 2. 데이터 보안
- **개인정보 보호**: 100% 가짜 데이터만 사용
- **Faker 라이브러리**: 한국어 이름, 주민번호, 주소 생성
- **랜덤화**: 매번 다른 데이터 생성 보장

### 3. 파일 관리
- **이미지 파일**: Git에서 제외 (.gitignore에 추가)
- **설정 파일**: YAML 형식으로 구조화
- **템플릿 파일**: assets/ 폴더에 체계적 정리

## 🔧 기술 스택

### 핵심 라이브러리
- **OpenCV**: 이미지 처리 및 회전
- **Pillow**: 텍스트 렌더링
- **Faker**: 가짜 데이터 생성
- **PyYAML**: 설정 파일 관리
- **NumPy**: 수치 계산

### 폰트
- **KoPub World Batang Medium**: 한국어 텍스트 렌더링

## 📁 프로젝트 구조

```
kdocs_synth/
├── assets/              # 리소스 파일
│   ├── fonts/          # 폰트 파일
│   ├── samples/        # 샘플 이미지
│   └── templates/      # 문서 템플릿
├── configs/            # 설정 파일
│   ├── field_definitions/  # 필드 정의
│   └── *_layout.yaml   # 레이아웃 좌표
├── src/                # 소스 코드
│   ├── data_factory.py     # 데이터 생성
│   ├── templates_juga.py   # 문서 렌더링
│   ├── batch_generator.py  # 배치 생성
│   ├── rotator.py          # 회전 처리
│   └── extract_layout.py   # 레이아웃 추출
├── outputs/            # 생성 결과물 (Git 제외)
├── tests/              # 테스트 파일
└── README.md           # 프로젝트 문서
```

## 🎨 문서 유형

### 가족관계증명서 (GA)
- **템플릿**: 2종 (가족1, 가족2)
- **가족 구성**: 4종 (자녀 0~3명)
- **주민번호**: OPEN/CLOSE 구분

### 주민등록등본 (JU)
- **템플릿**: 3종 (등본1, 등본2, 등본3)
- **바코드 조합**: 4종 (상단O/X, 하단O/X)
- **주민번호**: OPEN/CLOSE 구분
- **세대원 수**: 1~5명

## 📝 파일명 규칙

### 기본 형식
```
{문서구분}-{문서종류}-{주민번호공개여부}-{각도}-{순차번호5자리}
```

### 예시
```
GA-1-OPEN-0-00001.jpg    # 가족1, 주민번호공개, 정상
JU-2-CLOSE-L-00001.jpg   # 등본2, 주민번호미공개, 왼쪽90도
```

## 🔄 개발 워크플로우

### 1. 기능 개발
1. 요구사항 분석
2. 코드 구현
3. 단위 테스트
4. 통합 테스트
5. 문서 업데이트

### 2. Git 관리
- **커밋 메시지**: 명확하고 구체적으로 작성
- **브랜치**: 기능별로 분리
- **이미지 파일**: Git에서 제외

### 3. 품질 관리
- **코드 리뷰**: 주요 변경사항 검토
- **테스트**: 기능별 테스트 스크립트
- **문서화**: README 및 주석 업데이트

## 🚀 배포 및 실행

### 환경 설정
```bash
# Python 3.9+ 필요
pip install -r requirements.txt
```

### 실행 방법
```bash
# GA 배치 생성
python src/batch_generator_ga.py

# JU 배치 생성
python src/batch_generator.py

# 레이아웃 추출 도구
python src/extract_layout.py
```

## 📊 데이터 품질 기준

### 이미지 품질
- **해상도**: 원본 템플릿과 동일
- **폰트**: KoPub World 폰트 사용
- **좌표**: 정밀한 픽셀 단위 배치

### 데이터 다양성
- **랜덤화**: 매번 다른 데이터 생성
- **현실성**: 실제 문서와 유사한 패턴
- **완전성**: 모든 필드가 적절히 채워짐

## 🔒 보안 가이드라인

### 개인정보 보호
- **절대 금지**: 실제 개인정보 사용
- **가짜 데이터**: Faker 라이브러리만 사용
- **검증**: 생성된 데이터의 현실성 확인

### 파일 보안
- **로컬 저장**: 생성된 이미지는 로컬에만 저장
- **Git 제외**: 이미지 파일은 버전 관리에서 제외
- **백업**: 중요 설정 파일은 별도 백업

## 📈 성능 최적화

### 메모리 관리
- **이미지 처리**: 필요시에만 로드
- **배치 처리**: 대량 생성 시 메모리 효율성 고려
- **리소스 해제**: 사용 완료 후 명시적 해제

### 속도 최적화
- **캐싱**: 반복 사용되는 데이터 캐시
- **병렬 처리**: 가능한 경우 멀티스레딩 활용
- **알고리즘**: 효율적인 알고리즘 선택

## 🐛 디버깅 가이드

### 로그 관리
- **로그 레벨**: 적절한 로그 레벨 사용
- **에러 추적**: 상세한 에러 메시지 제공
- **디버그 모드**: 개발 시 디버그 정보 출력

### 테스트 전략
- **단위 테스트**: 개별 함수/클래스 테스트
- **통합 테스트**: 전체 워크플로우 테스트
- **시각적 검증**: 생성된 이미지 품질 확인

## 📚 문서화 표준

### 코드 문서화
- **Docstring**: 모든 함수와 클래스에 작성
- **타입 힌트**: Python 타입 힌트 사용
- **주석**: 복잡한 로직에 상세한 주석

### 프로젝트 문서화
- **README.md**: 프로젝트 개요 및 사용법
- **project_flow.md**: 개발 진행 상황
- **API 문서**: 주요 함수 인터페이스

## 🔄 유지보수

### 코드 리팩토링
- **정기적 검토**: 코드 품질 정기 검토
- **중복 제거**: 공통 기능 모듈화
- **성능 개선**: 지속적인 성능 최적화

### 버전 관리
- **시맨틱 버전**: 의미있는 버전 번호
- **변경 로그**: 주요 변경사항 기록
- **호환성**: 하위 호환성 유지

---

**마지막 업데이트**: 2024년 7월 31일
**버전**: 1.0.0 